import requests

ClientID = "d5987aef-6fa5-4526-b4bb-de81be6322e4"
ClientSecret = "zBj4JK2tqgRC6mPoVOd3WQFaLKNNutYTJcOwkF5ELLo="
TenantDomain = "vpaliath.onmicrosoft.com"
OutputDirectory = "D:\Reports"

loginURL = 'https://login.microsoft.com'

#Build OAuth teques
post_data = {'grant_type': 'client_credentials',
             'resource': 'https://graph.microsoft.com',
             'client_id': 'd5987aef-6fa5-4526-b4bb-de81be6322e4',
             'client_secret': 'zBj4JK2tqgRC6mPoVOd3WQFaLKNNutYTJcOwkF5ELLo'
             }

r = requests.post(loginURL + TenantDomain +"oauth2/token?api-version=1.0")
if r.status_code == 200:
   root = ET.fromstring(r.text)
   if 'token' in root.attrib:
      token = root.attrib['token']
      print ("Login Successful")
      print (token)
else:
    print ("login Unsuccessful")
